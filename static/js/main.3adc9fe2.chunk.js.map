{"version":3,"sources":["AppShell/store.ts","utils/animation.ts","utils/audio.ts","utils/browser.ts","utils/system.ts","utils/state.ts","features/Camera/store.ts","features/User/store.ts","features/SnapMap/data.ts","features/SnapMap/store.ts","features/SnapMap/utils.ts","features/Snap/store.ts","features/Chat/store.ts","common/Icon/index.tsx","common/Button/index.tsx","common/Input/index.tsx","common/Header/index.tsx","AppShell/utils.ts","AppShell/Toolbar/index.tsx","common/Widget/index.tsx","common/PodActionItem/index.tsx","common/Loader/index.tsx","features/Account/Map/index.tsx","features/Account/index.tsx","common/Avatar/index.tsx","common/PodUser/index.tsx","common/Error/index.tsx","features/Search/index.tsx","utils/string.ts","features/SnapMap/Header/index.tsx","features/SnapMap/index.tsx","features/Snap/index.tsx","utils/time.ts","features/Archive/index.tsx","features/Chat/data.ts","common/Pill/index.tsx","features/Chat/index.tsx","utils/array.ts","common/SkeletonFrame/index.tsx","common/PodSpotlight/index.tsx","features/Discover/index.tsx","utils/viewport.ts","AppShell/Drawer/index.tsx","AppShell/Footer/index.tsx","AppShell/index.tsx","features/Camera/PhotoCapture/index.tsx","features/Camera/index.tsx","features/404/index.tsx","index.tsx"],"names":["appSlice","createSlice","name","initialState","drawers","footerType","reducers","showDrawer","reducer","state","action","drawer","payload","minusCurrentDrawer","filter","component","prepare","animationIn","animationOut","animationInDuration","animationOutDuration","theme","position","show","hideDrawer","map","hideAllDrawers","openDrawers","lastDrawerOpen","length","setFooterType","actions","onAnimationComplete","callback","setTimeout","playSound","sound","audioElem","a","soundMap","newAppMessage","cameraShutter","src","play","navigator","language","userAgent","api","baseURL","get","endpoint","external","respond","post","options","put","patch","delete","method","data","url","headers","Headers","body","JSON","stringify","fetch","response","json","promise","then","Error","catch","err","sleep","milliseconds","Promise","resolve","loadable","loading","error","cameraMode","photoTaken","photos","getPhotos","createAsyncThunk","cameraSlice","setPhoto","month","year","dataURL","images","unshift","time","Date","toLocaleString","getFullYear","toggleCameraMode","extraReducers","builder","addCase","pending","fulfilled","rejected","session","id","username","avatar","gender","age","fullName","geolocation","country","city","zip","latitude","longitude","friends","getSession","getFriends","getGeoLocation","country_name","postal","userSlice","setLatLon","abbrConditionMap","sn","sl","h","t","s","c","hr","lr","hc","lc","conditionIconMap","snow","sleet","hail","thunderstorm","showers","clear","getSnaps","lat","lon","coords","snaps","snap","index","location","getWeather","encodeURIComponent","weather","temperature","condition","whereOnEarthID","parse","contents","woeid","consolidated_weather","the_temp","weather_state_abbr","celsius","Math","round","snapMapSlice","defaultSnap","type","caption","shareable","snapSlice","addSnap","removeSnap","thread","messages","getMessages","user","chatSlice","postMessage","author","message","push","uuid","iconMap","faSnapchatSquare","faGithub","faCircle","faCamera","faUserPlus","faListAlt","faGrinBeam","faAngleRight","faCompass","faUserCircle","faSearch","faRetweet","faAngleDown","faLocationArrow","faSignal","faBatteryHalf","faCommentAlt","faMobile","faMobileAlt","faDot","faLaugh","faSmileWink","faEllipsisV","faEllipsisH","faCog","faTimesCircle","faTimes","faAngleLeft","faSearchPlus","faPaw","faSpider","faWater","faPhoneAlt","faVideo","faRocket","faMicrophone","faDownload","faTextHeight","faPen","faStickyNote","faCut","faPaperclip","faCropAlt","faStopwatch","faExternalLinkAlt","faPlayCircle","faEdit","faMagic","faQrcode","faSnowflake","faIcicles","faCloudMeatball","faPooStorm","faCloudShowersHeavy","faCloudRain","faCloud","faCloudSun","faSun","faExclamationCircle","Icon","icon","onClick","className","classNames","Button","image","icons","iconClass","iconClasses","buttonClass","plain","purple","label","onclick","testId","data-test","alt","key","Input","placeholder","value","leftIcon","rightIcon","onFocus","onBlur","onChange","onEnter","focus","spellCheck","animate","dark","inputElem","useRef","useState","full","setFull","useEffect","current","disabled","ref","onKeyPress","Header","insideDrawer","dispatch","useDispatch","useSelector","iconImage","test","alert","atleastOneDrawerOpen","some","Toolbar","app","setTime","updateTime","toLocaleTimeString","hour","minute","replace","setInterval","Widget","header","transparent","children","PodActionItem","straightEdge","Loader","fixed","nobg","Array","fill","val","apiKey","process","hasApiKey","mapboxgl","accessToken","Map","mapElem","setLoading","loadMap","dummyResponse","getCurrentPosition","maximumAge","Infinity","timeout","enableHighAccuracy","container","style","center","zoom","interactive","on","tooltip","document","createElement","Marker","setLngLat","addTo","role","aria-label","href","target","rel","currentDate","toLocaleDateString","day","Account","title","sizeMap","sm","md","lg","Avatar","size","width","PodUser","Search","query","setQuery","pattern","RegExp","users","match","hasResults","e","currentTarget","isVisible","snapMap","SnapMap","setMap","classList","add","Popup","closeOnClick","setHTML","addSelfMarker","flyTo","marker","setAttribute","remove","addSnapToMap","Snap","videoElem","load","closeSnap","metadata","timestamp","elapsed","now","floor","msPerMinute","msPerHour","msPerDay","relativeTime","playsInline","onEnded","Archive","camera","openPhoto","dummyMessages","Pill","Chat","chat","messageContainer","setMessage","typing","setTyping","useLayoutEffect","scrollTop","scrollHeight","botResponse","useCallback","firstMsg","typeAndStop","i","prevTyping","arr","random","submitMessage","other","SkeletonFrame","count","PodSpotlight","Discover","drawerContent","loadMore","isFetching","onScroll","func","wait","args","later","clearTimeout","debounce","elem","fullyVisible","getBoundingClientRect","elemTop","top","elemBottom","bottom","window","innerHeight","elemInView","setPage","prevPage","page","profiles","setProfiles","addEventListener","prevProfiles","discover","removeEventListener","Drawer","getElementById","height","account","search","archive","getComponent","Footer","animateOnMount","AppShell","PhotoCapture","takePic","closePic","canvasElem","documentElement","viewportHeight","setProperty","stretchViewPortHeight","getDataURL","toDataURL","innerWidth","context","getContext","canvas","drawImage","takePhoto","hide","button","MSStream","open","link","download","click","defaultFilters","errorMessageMap","GL_INCOMPATIBLE","Camera","showFilterButtons","setShowFilterButtons","filters","setFilters","activeFilter","setActiveFilter","filterInitialized","setFilterInitialized","cameraStream","setCameraStream","setTakePic","hasBrowserSupport","setHasBrowserSupport","startCamera","maxWidth","querySelector","offsetWidth","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","reject","call","video","facingMode","ideal","srcObject","setActiveFilterButton","selectFilter","newFilters","splice","switchFilter","JEEFACEFILTERAPI","destroy","stopFilter","Filters","init","errCode","getTracks","forEach","track","stop","includes","muted","autoPlay","NotFound","to","store","configureStore","App","StrictMode","path","exact","ReactDOM","render"],"mappings":"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","file":"static/js/main.3adc9fe2.chunk.js","sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { DrawerComponent, Drawer, FooterType } from 'AppShell/types';\n\nconst initialState: {\n  drawers: Drawer[];\n  footerType: FooterType;\n} = {\n  drawers: [],\n  footerType: 'full'\n};\n\nconst appSlice = createSlice({\n  name: 'app',\n  initialState,\n  reducers: {\n    showDrawer: {\n      reducer(state, action: PayloadAction<Drawer>) {\n        const drawer = action.payload;\n        const minusCurrentDrawer = state.drawers.filter(\n          ({ component }) => component !== drawer.component\n        );\n        state.drawers = [...minusCurrentDrawer, drawer];\n      },\n      prepare(drawer: Drawer) {\n        const drawerDefaults = {\n          animationIn: 'slideInUp',\n          animationOut: 'slideOutDown',\n          animationInDuration: 300,\n          animationOutDuration: 300,\n          theme: 'light',\n          position: 'front',\n          show: true\n        } as Drawer;\n        return {\n          payload: {\n            ...drawerDefaults,\n            ...drawer\n          }\n        };\n      }\n    },\n    hideDrawer(state, action: PayloadAction<DrawerComponent>) {\n      const component = action.payload;\n      state.drawers = state.drawers.map((drawer) => {\n        if (drawer.component === component)\n          return {\n            ...drawer,\n            show: false\n          };\n        return drawer;\n      });\n    },\n    hideAllDrawers(state) {\n      const openDrawers = state.drawers.filter(({ show }) => show);\n      const lastDrawerOpen = openDrawers[openDrawers.length - 1].component;\n      let drawers;\n\n      // If only 1 drawer is open just close it\n      if (openDrawers.length === 1) {\n        drawers = state.drawers.map((drawer) => ({\n          ...drawer,\n          show: false\n        }));\n      }\n      // If more than 1 drawer is open, close them all but show exit animation only on the last opened one\n      else {\n        drawers = state.drawers.map((drawer) => {\n          if (drawer.component === lastDrawerOpen)\n            return {\n              ...drawer,\n              show: false\n            };\n          return {\n            ...drawer,\n            show: false,\n            animationOutDuration: 0\n          };\n        });\n      }\n\n      state.drawers = drawers;\n    },\n    setFooterType(state, action: PayloadAction<FooterType>) {\n      state.footerType = action.payload;\n    }\n  }\n});\n\nexport const { showDrawer, hideDrawer, hideAllDrawers, setFooterType } = appSlice.actions;\n\nexport default appSlice.reducer;\n","// Run a callback function after an animation transition is complete\n// This is to prevent frame choppiness which happens if running too many things at once during the animation\n// 300ms is the default animation in and out duration on drawers so it's also the default here\nexport const onAnimationComplete = (callback, animationInDuration = 300) =>\n  setTimeout(callback, animationInDuration);\n","export const playSound = async (sound: string, audioElem: HTMLAudioElement) => {\n  const soundMap = {\n    newAppMessage: './audio/blip.mp3',\n    cameraShutter: './audio/shutter.mp3'\n  };\n  // IOS no longer allows sounds to be played without a user action\n  // passing an audio tag from the component and setting it's `src` attribute\n  // and then paying it seems to bypass this restriction for now..\n  audioElem.src = soundMap[sound];\n  try {\n    await audioElem.play();\n  } catch (err) {}\n};\n","export const { language = 'en-US', userAgent } = navigator;\n\nexport const isIOS = (): boolean =>\n  /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream;\n\nexport const isMobile = (): boolean =>\n  /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);\n","export const api = {\n  baseURL: './api',\n  get: (endpoint, external = false) => api.respond('get', endpoint, null, external),\n  post: (endpoint, options) => api.respond('post', endpoint, options),\n  put: (endpoint, options) => api.respond('put', endpoint, options),\n  patch: (endpoint, options) => api.respond('patch', endpoint, options),\n  delete: (endpoint) => api.respond('delete', endpoint),\n  respond: async (method, endpoint, data?, external?) => {\n    const url = external ? endpoint : api.baseURL + endpoint;\n    const options = data\n      ? {\n          headers: new Headers({ 'Content-Type': 'application/json' }),\n          body: JSON.stringify(data)\n        }\n      : {};\n    try {\n      const response = await fetch(url, { method, ...options });\n      const data = await response.json();\n      return [null, data];\n    } catch (error) {\n      return [error];\n    }\n  }\n};\n\n// https://gist.github.com/DavidWells/54f9dd1af4a489e5f1358f33ce59e8ad\nexport const promise = (promise: Promise<[boolean, any]>) =>\n  promise\n    .then((data) => {\n      if (data instanceof Error) return [data];\n      return [null, data];\n    })\n    .catch((err) => [err]);\n\n// https://levelup.gitconnected.com/debounce-in-javascript-improve-your-applications-performance-5b01855e086\nexport const debounce = (func, wait) => {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      timeout = null;\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\nexport const sleep = (milliseconds) =>\n  new Promise((resolve) => setTimeout(resolve, milliseconds));\n","export const loadable = {\n  loading: false,\n  error: false,\n  data: []\n};\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { Photos, CameraMode } from './types';\n\nconst initialState: {\n  cameraMode: CameraMode;\n  photoTaken: boolean;\n  photos: Loadable<Photos>;\n} = {\n  cameraMode: 'user',\n  photoTaken: false,\n  photos: loadable\n};\n\nexport const getPhotos = createAsyncThunk('photos/getPhotos', async () => {\n  const [error, response] = await api.get('/photos.json');\n  if (!error) return response.photos;\n});\n\nconst cameraSlice = createSlice({\n  name: 'photos',\n  initialState,\n  reducers: {\n    setPhoto: {\n      reducer(\n        state,\n        action: PayloadAction<{\n          month: string;\n          year: number;\n          dataURL: string;\n        }>\n      ) {\n        const { month, year, dataURL } = action.payload;\n        if (state.photoTaken) {\n          state.photos[0].data.images.unshift(action.payload.dataURL);\n        } else {\n          state.photoTaken = true;\n          state.photos.data.unshift({\n            month,\n            year,\n            images: [dataURL]\n          });\n        }\n      },\n      prepare(dataURL: string) {\n        const time = new Date();\n        return {\n          payload: {\n            dataURL,\n            month: time.toLocaleString('default', { month: 'long' }),\n            year: time.getFullYear()\n          }\n        };\n      }\n    },\n    toggleCameraMode(state) {\n      state.cameraMode = state.cameraMode === 'user' ? 'environment' : 'user';\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getPhotos.pending, ({ photos }) => {\n      photos.loading = true;\n    });\n    builder.addCase(getPhotos.fulfilled, ({ photos }, { payload }) => {\n      photos.loading = false;\n      if (payload) photos.data = payload;\n      else photos.error = true;\n    });\n    builder.addCase(getPhotos.rejected, ({ photos }) => {\n      photos.loading = false;\n      photos.error = true;\n    });\n  }\n});\n\nexport const { setPhoto, toggleCameraMode } = cameraSlice.actions;\n\nexport default cameraSlice.reducer;\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { User, Geolocation } from './types';\n\nconst initialState: {\n  session: User;\n  geolocation: Geolocation;\n  friends: Loadable<User[]>;\n} = {\n  session: {\n    id: '',\n    username: '',\n    avatar: '',\n    gender: 'other',\n    age: 0,\n    fullName: ''\n  },\n  geolocation: {\n    country: '',\n    state: '',\n    city: '',\n    zip: '',\n    latitude: 0,\n    longitude: 0\n  },\n  friends: loadable\n};\n\nexport const getSession = createAsyncThunk('user/sessionFetched', async () => {\n  const [error, response] = await api.get('/session.json');\n  if (error) return false;\n  return response.session;\n});\n\nexport const getFriends = createAsyncThunk('user/friendsFetched', async () => {\n  const [error, response] = await api.get('/friends.json');\n  if (error) return false;\n  return response.friends;\n});\n\nexport const getGeoLocation = createAsyncThunk('user/geoLocationFetched', async () => {\n  const [error, response] = await api.get('https://geolocation-db.com/json/', true);\n\n  if (error) return false;\n\n  const { country_name, state, city, postal, latitude, longitude } = response;\n\n  return {\n    country: country_name,\n    state,\n    city,\n    zip: postal,\n    latitude,\n    longitude\n  };\n});\n\nconst userSlice = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {\n    setLatLon(state, action: PayloadAction<{ latitude: number; longitude: number }>) {\n      const { geolocation } = state;\n      const { latitude, longitude } = action.payload;\n      geolocation.latitude = latitude;\n      geolocation.longitude = longitude;\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getSession.fulfilled, (state, { payload }) => {\n      if (payload) state.session = payload;\n    });\n    builder.addCase(getGeoLocation.fulfilled, (state, { payload }) => {\n      if (payload) state.geolocation = payload;\n    });\n    builder.addCase(getFriends.pending, ({ friends }) => {\n      friends.loading = true;\n    });\n    builder.addCase(getFriends.fulfilled, ({ friends }, { payload }) => {\n      friends.loading = false;\n      if (payload) friends.data = payload;\n      else friends.error = true;\n    });\n    builder.addCase(getFriends.rejected, ({ friends }) => {\n      friends.loading = false;\n      friends.error = true;\n    });\n  }\n});\n\nexport const { setLatLon } = userSlice.actions;\n\nexport default userSlice.reducer;\n","export const abbrConditionMap = {\n  sn: 'snow',\n  sl: 'sleet',\n  h: 'hail',\n  t: 'thunderstorm',\n  s: 'showers',\n  c: 'clear',\n  hr: 'heavy-rain',\n  lr: 'light-rain',\n  hc: 'heavy-cloud',\n  lc: 'light-cloud'\n};\n\nexport const conditionIconMap = {\n  snow: 'faSnowflake',\n  sleet: 'faIcicles',\n  hail: 'faCloudMeatball',\n  thunderstorm: 'faPooStorm',\n  showers: 'faCloudShowersHeavy',\n  clear: 'faSun',\n  'heavy-rain': 'faCloudShowersHeavy',\n  'light-rain': 'faCloudRain',\n  'heavy-cloud': 'faCloud',\n  'light-cloud': 'faCloudSun'\n};\n","import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { api } from 'utils';\nimport { celsiusToFahrenheit } from './utils';\nimport { Snap } from 'features/Snap/types';\nimport { Weather } from './types';\nimport { abbrConditionMap } from './data';\n\nconst initialState: {\n  snaps: Snap[];\n  weather: Weather;\n} = {\n  snaps: [],\n  weather: {\n    temperature: 0,\n    condition: ''\n  }\n};\n\nexport const getSnaps = createAsyncThunk(\n  'snapMap/snapsFetched',\n  async ({\n    lat,\n    lon,\n    city,\n    state\n  }: {\n    lat: number;\n    lon: number;\n    city: string;\n    state: string;\n  }) => {\n    const [error, response] = await api.get(`/snaps.json?geo=${lat},${lon}`);\n\n    if (error) return false;\n\n    // Set some dummy coordinates to make snaps seem close to user\n    const coords = [\n      {\n        lat: lat + 0.006,\n        lon: lon - 0.006\n      },\n      {\n        lat: lat + 0.009,\n        lon: lon + 0.005\n      },\n      {\n        lat: lat + 0.006,\n        lon: lon - 0.001\n      },\n      {\n        lat: lat - 0.005,\n        lon: lon - 0.002\n      },\n      {\n        lat: lat - 0.001,\n        lon: lon - 0.005\n      },\n      {\n        lat: lat + 0.005,\n        lon: lon - -0.006\n      },\n      {\n        lat: lat,\n        lon: lon + 0.004\n      }\n    ];\n\n    const snaps = response.snaps.map((snap, index) => ({\n      ...snap,\n      location: city && state ? `${city}, ${state}` : null,\n      lat: coords[index].lat,\n      lon: coords[index].lon\n    }));\n\n    return snaps;\n  }\n);\n\nexport const getWeather = createAsyncThunk(\n  'snapMap/weatherFetched',\n  async ({ lat, lon }: { lat: number; lon: number }) => {\n    // Hit the weather API through a free CORs proxy so we don't have to write one for this project..\n    const baseURL = `https://api.allorigins.win/get?url=${encodeURIComponent(\n      'https://www.metaweather.com/api/location'\n    )}`;\n\n    // If fetching the user's actual weather fails below for some reason\n    // store this dummy data for purposes of the demo\n    let weather = {\n      temperature: 75,\n      condition: 'clear'\n    };\n\n    let [error, response] = await api.get(\n      `${baseURL}/search/?lattlong=${lat},${lon}`,\n      true\n    );\n\n    if (error) return false;\n\n    const whereOnEarthID = JSON.parse(response.contents)[0]?.woeid;\n    [error, response] = await api.get(`${baseURL}/${whereOnEarthID}/`, true);\n\n    if (error) return false;\n\n    const { the_temp, weather_state_abbr } = JSON.parse(\n      response?.contents\n    ).consolidated_weather[0];\n\n    weather = {\n      temperature: celsiusToFahrenheit(the_temp),\n      condition: abbrConditionMap[weather_state_abbr]\n    };\n\n    return weather;\n  }\n);\n\nconst snapMapSlice = createSlice({\n  name: 'snapMap',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(getWeather.fulfilled, (state, { payload }) => {\n      if (payload) state.weather = payload;\n    });\n    builder.addCase(getSnaps.fulfilled, (state, { payload }) => {\n      if (payload) state.snaps = payload;\n    });\n  }\n});\n\nexport default snapMapSlice.reducer;\n","export const celsiusToFahrenheit = (celsius: number): number =>\n  Math.round(celsius * 1.8 + 32);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Snap } from './types';\n\nconst defaultSnap: Snap = {\n  type: '',\n  url: '',\n  location: '',\n  lat: 0,\n  lon: 0,\n  time: 0,\n  caption: '',\n  shareable: false\n};\n\nconst initialState: Snap = defaultSnap;\n\nconst snapSlice = createSlice({\n  name: 'snap',\n  initialState,\n  reducers: {\n    addSnap(state, { payload }: PayloadAction<Snap>) {\n      return payload;\n    },\n    removeSnap(state) {\n      return defaultSnap;\n    }\n  }\n});\n\nexport const { addSnap, removeSnap } = snapSlice.actions;\n\nexport default snapSlice.reducer;\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { v4 as uuid } from 'uuid';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { Message } from './types';\n\nconst initialState: {\n  thread: string;\n  messages: Loadable<Message[]>;\n} = {\n  thread: 'Lisa',\n  messages: loadable\n};\n\nexport const getMessages = createAsyncThunk(\n  'chat/messagesReceived',\n  async (user: string) => {\n    const [error, response] = await api.get(`/messages.json?thread=${user}`);\n    if (error) return false;\n    return response.messages;\n  }\n);\n\nconst chatSlice = createSlice({\n  name: 'chat',\n  initialState,\n  reducers: {\n    postMessage: {\n      reducer(\n        state,\n        action: PayloadAction<{\n          id: string;\n          author: string;\n          message: string;\n          time: string;\n        }>\n      ) {\n        const { id, author, message, time } = action.payload;\n        state.messages.data.push({\n          id,\n          author,\n          message,\n          time\n        });\n      },\n      prepare(author: string, message: string) {\n        return {\n          payload: {\n            id: uuid(),\n            author,\n            message,\n            time: JSON.stringify(new Date())\n          }\n        };\n      }\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getMessages.pending, ({ messages }) => {\n      messages.loading = true;\n    });\n    builder.addCase(getMessages.fulfilled, ({ messages }, { payload }) => {\n      messages.loading = false;\n      if (payload) messages.data = payload;\n      else messages.error = true;\n    });\n    builder.addCase(getMessages.rejected, ({ messages }) => {\n      messages.loading = false;\n      messages.error = true;\n    });\n  }\n});\n\nexport const { postMessage } = chatSlice.actions;\n\nexport default chatSlice.reducer;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSnapchatSquare, faGithub } from '@fortawesome/free-brands-svg-icons';\nimport { faCircle } from '@fortawesome/free-regular-svg-icons';\nimport {\n  faCamera,\n  faUserPlus,\n  faListAlt,\n  faGrinBeam,\n  faAngleRight,\n  faCompass,\n  faUserCircle,\n  faSearch,\n  faRetweet,\n  faAngleDown,\n  faLocationArrow,\n  faSignal,\n  faBatteryHalf,\n  faCommentAlt,\n  faMobile,\n  faMobileAlt,\n  faCircle as faDot,\n  faLaugh,\n  faSmileWink,\n  faEllipsisV,\n  faEllipsisH,\n  faCog,\n  faTimesCircle,\n  faTimes,\n  faAngleLeft,\n  faSearchPlus,\n  faPaw,\n  faSpider,\n  faWater,\n  faPhoneAlt,\n  faVideo,\n  faRocket,\n  faMicrophone,\n  faDownload,\n  faTextHeight,\n  faPen,\n  faStickyNote,\n  faCut,\n  faPaperclip,\n  faCropAlt,\n  faStopwatch,\n  faExternalLinkAlt,\n  faPlayCircle,\n  faEdit,\n  faMagic,\n  faQrcode,\n  faSnowflake,\n  faIcicles,\n  faCloudMeatball,\n  faPooStorm,\n  faCloudShowersHeavy,\n  faCloudRain,\n  faCloud,\n  faCloudSun,\n  faSun,\n  faExclamationCircle\n} from '@fortawesome/free-solid-svg-icons';\nimport './index.scss';\n\nexport const iconMap = {\n  // free-brands-svg-icons\n  faSnapchatSquare,\n  faGithub,\n  // free-regular-svg-icons\n  faCircle,\n  // free-solid-svg-icons\n  faCamera,\n  faUserPlus,\n  faListAlt,\n  faGrinBeam,\n  faAngleRight,\n  faCompass,\n  faUserCircle,\n  faSearch,\n  faRetweet,\n  faAngleDown,\n  faLocationArrow,\n  faSignal,\n  faBatteryHalf,\n  faCommentAlt,\n  faMobile,\n  faMobileAlt,\n  faDot,\n  faLaugh,\n  faSmileWink,\n  faEllipsisV,\n  faEllipsisH,\n  faCog,\n  faTimesCircle,\n  faTimes,\n  faAngleLeft,\n  faSearchPlus,\n  faPaw,\n  faSpider,\n  faWater,\n  faPhoneAlt,\n  faVideo,\n  faRocket,\n  faMicrophone,\n  faDownload,\n  faTextHeight,\n  faPen,\n  faStickyNote,\n  faCut,\n  faPaperclip,\n  faCropAlt,\n  faStopwatch,\n  faExternalLinkAlt,\n  faPlayCircle,\n  faEdit,\n  faMagic,\n  faQrcode,\n  faSnowflake,\n  faIcicles,\n  faCloudMeatball,\n  faPooStorm,\n  faCloudShowersHeavy,\n  faCloudRain,\n  faCloud,\n  faCloudSun,\n  faSun,\n  faExclamationCircle\n};\n\nconst Icon: React.FC<{\n  readonly icon: string;\n  readonly onClick?: () => void;\n  readonly className?: string;\n}> = ({ icon, onClick, className = '' }) =>\n  icon ? (\n    <FontAwesomeIcon\n      icon={iconMap[icon]}\n      onClick={onClick}\n      className={classNames('icon', {\n        [className]: true\n      })}\n    />\n  ) : null;\n\nexport default Icon;\n","import React from 'react';\nimport classNames from 'classnames';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst Button: React.FC<{\n  readonly image?: string;\n  readonly icon?: string;\n  readonly icons?: string[];\n  readonly iconClass?: string;\n  readonly iconClasses?: Array<string | null>;\n  readonly buttonClass?: string;\n  readonly round?: boolean;\n  readonly plain?: boolean;\n  readonly purple?: boolean;\n  readonly label?: string;\n  readonly onclick?: () => void;\n  readonly testId?: string;\n}> = ({\n  image,\n  icon,\n  icons,\n  iconClass = '',\n  iconClasses = [],\n  buttonClass = '',\n  round,\n  plain,\n  purple,\n  label,\n  onclick,\n  testId\n}) => (\n  <button\n    type=\"button\"\n    onClick={onclick}\n    className={classNames('btn', {\n      [buttonClass]: true,\n      round,\n      plain,\n      purple\n    })}\n    data-test={testId}\n  >\n    {image ? (\n      <img src={image} alt=\"\" />\n    ) : icons ? (\n      icons.map((icon, index) => (\n        <Icon\n          key={icon + index}\n          icon={icon}\n          className={classNames({\n            [iconClasses[index] as string]: iconClasses[index]\n          })}\n        />\n      ))\n    ) : icon ? (\n      <Icon\n        icon={icon}\n        className={classNames({\n          [iconClass]: true\n        })}\n      />\n    ) : null}\n    {label && <strong>{label}</strong>}\n  </button>\n);\n\nexport default Button;\n","import React, { useRef, useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { onAnimationComplete } from 'utils';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst Input: React.FC<{\n  readonly placeholder: string;\n  readonly value?: string;\n  readonly leftIcon?: string;\n  readonly rightIcon?: string;\n  readonly onClick?: () => void;\n  readonly onFocus?: () => void;\n  readonly onBlur?: () => void;\n  readonly onChange?: (e: React.SyntheticEvent<HTMLInputElement>) => void;\n  readonly onEnter?: () => void;\n  readonly focus?: boolean;\n  readonly spellCheck?: boolean;\n  readonly animate?: boolean;\n  readonly dark?: boolean;\n}> = ({\n  placeholder,\n  value,\n  leftIcon,\n  rightIcon,\n  onClick,\n  onFocus,\n  onBlur,\n  onChange,\n  onEnter,\n  focus,\n  spellCheck,\n  animate,\n  dark\n}) => {\n  const inputElem = useRef<HTMLInputElement>(null);\n  const [full, setFull] = useState(false);\n\n  useEffect(() => {\n    if (animate) setFull(true);\n    onAnimationComplete(() => {\n      if (focus) inputElem?.current?.focus();\n    });\n  }, [animate, focus]);\n\n  const disabled = onClick ? true : false;\n\n  return (\n    <div className={classNames('input', { animate, full, dark })} data-test=\"input\">\n      {disabled && <div className=\"disabled-overlay\" onClick={onClick} />}\n      {leftIcon && <Icon icon={leftIcon} className=\"left-icon\" />}\n      <input\n        type=\"text\"\n        ref={inputElem}\n        placeholder={placeholder}\n        value={value}\n        onClick={onClick}\n        onFocus={onFocus}\n        onBlur={onBlur}\n        onChange={onChange}\n        onKeyPress={({ key }) => onEnter && key === 'Enter' && onEnter()}\n        disabled={disabled}\n        spellCheck={spellCheck || false}\n        className={classNames({ 'has-left-icon': leftIcon })}\n        data-test=\"field\"\n      />\n      {rightIcon && <Icon icon={rightIcon} className=\"right-icon\" />}\n    </div>\n  );\n};\n\nexport default Input;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { toggleCameraMode } from 'features/Camera/store';\nimport { isMobile } from 'utils';\nimport Icon from 'common/Icon';\nimport Button from 'common/Button';\nimport Input from 'common/Input';\nimport './index.scss';\n\nconst Header: React.FC<{\n  readonly insideDrawer?: boolean;\n}> = ({ insideDrawer }) => {\n  const dispatch = useDispatch();\n  const avatar = useSelector(({ user }) => user.session.avatar);\n\n  const iconImage = avatar ? { image: avatar } : { icon: 'faUserCircle' };\n\n  return (\n    <header className=\"header\" data-test=\"header\">\n      <Button\n        {...iconImage}\n        onclick={() => dispatch(showDrawer({ component: 'account' }))}\n        buttonClass=\"btn-user\"\n        testId=\"btn-user\"\n      />\n      <Input\n        placeholder=\"Search\"\n        leftIcon=\"faSearch\"\n        rightIcon=\"faUserPlus\"\n        dark={insideDrawer}\n        onClick={() =>\n          dispatch(\n            showDrawer({\n              component: 'search',\n              animationIn: 'fadeIn',\n              animationOut: 'fadeOut',\n              animationInDuration: 200,\n              animationOutDuration: 200\n            })\n          )\n        }\n      />\n      <div className=\"right\">\n        {insideDrawer ? (\n          <Icon icon=\"faEllipsisH\" />\n        ) : (\n          <Button\n            icon=\"faRetweet\"\n            buttonClass=\"btn-flip-camera\"\n            onclick={() => {\n              if (isMobile()) {\n                dispatch(toggleCameraMode());\n              } else {\n                alert('You need a front facing camera for this, try it on your phone!');\n              }\n            }}\n          />\n        )}\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","import { Drawer } from './types';\n\nexport const atleastOneDrawerOpen = (drawers: Drawer[]): boolean =>\n  drawers.some(({ show }) => show);\n","import React, { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport classNames from 'classnames';\nimport { language } from 'utils';\nimport { atleastOneDrawerOpen } from '../utils';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst Toolbar: React.FC = () => {\n  const drawers = useSelector(({ app }) => app.drawers);\n  const [time, setTime] = useState('');\n\n  const updateTime = () => {\n    const time = new Date()\n      .toLocaleTimeString(language, {\n        hour: 'numeric',\n        minute: '2-digit'\n      })\n      .replace(/AM|PM/, '');\n    setTime(time);\n  };\n\n  useEffect(() => {\n    updateTime();\n    setInterval(updateTime, 1000);\n  }, []);\n\n  return (\n    <div\n      className={classNames('toolbar', {\n        dark: atleastOneDrawerOpen(drawers)\n      })}\n    >\n      <div className=\"left\">\n        <time>{time}</time>\n        <Icon icon=\"faLocationArrow\" />\n      </div>\n      <div className=\"right\">\n        <Icon icon=\"faSignal\" className=\"icon-signal\" />\n        <Icon icon=\"faBatteryHalf\" />\n      </div>\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import React from 'react';\nimport classNames from 'classnames';\nimport './index.scss';\n\nconst Widget: React.FC<{\n  readonly header: string;\n  readonly className?: string;\n  readonly transparent?: boolean;\n}> = ({ header, className = '', transparent, children }) => (\n  <section\n    className={classNames('widget', {\n      [className]: true\n    })}\n  >\n    <header>{header}</header>\n    <div className={classNames('inner-content', { transparent })}>{children}</div>\n  </section>\n);\n\nexport default Widget;\n","import React from 'react';\nimport classNames from 'classnames';\nimport Icon from 'common/Icon';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst PodActionItem: React.FC<{\n  readonly leftIcon: string;\n  readonly rightIcon: string;\n  readonly label: string;\n  readonly straightEdge?: boolean;\n}> = ({ leftIcon, rightIcon, label, straightEdge }) => (\n  <article\n    className={classNames('pod', 'action-item', {\n      'straight-edge': straightEdge\n    })}\n  >\n    <Icon icon={leftIcon} className=\"ico-left\" />\n    {label}\n    <Button icon={rightIcon} buttonClass=\"ico-right\" />\n  </article>\n);\n\nexport default PodActionItem;\n","import React from 'react';\nimport classNames from 'classnames';\nimport './index.scss';\n\nconst Loader: React.FC<{\n  readonly fixed?: boolean;\n  readonly nobg?: boolean;\n  readonly message?: string;\n}> = ({ fixed, nobg, message }) => (\n  <div className={classNames('loading', { fixed, message, nobg })}>\n    <div className=\"center\">\n      <div className=\"sk-cube-grid\">\n        {new Array(9).fill(null).map((val, index) => (\n          <div key={`cube-${index}`} className={'sk-cube sk-cube' + index}></div>\n        ))}\n      </div>\n      {message && <span>{message}</span>}\n    </div>\n  </div>\n);\n\nexport default Loader;\n","import React, { useRef, useState, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { getGeoLocation, setLatLon } from 'features/User/store';\nimport Loader from 'common/Loader';\nimport './index.scss';\n\nconst apiKey = process.env.REACT_APP_MAP_BOX_API_KEY;\nconst hasApiKey = apiKey?.length ? true : false;\nif (hasApiKey) mapboxgl.accessToken = apiKey as string;\n\nconst Map: React.FC = () => {\n  const dispatch = useDispatch();\n  const mapElem = useRef<HTMLDivElement>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!hasApiKey) return;\n\n    (async () => {\n      // Attempt to get the user's geo location via this endpoint `https://geolocation-db.com/json/` (IP based)\n      // if it fails ask the user for their location via the `navigator.geolocation` API (much slower)\n      const response = await dispatch(getGeoLocation());\n\n      if (response.payload) {\n        const { latitude, longitude } = response.payload;\n        loadMap(latitude, longitude);\n      } else {\n        const respond = (lat, lon) => {\n          loadMap(lat, lon);\n\n          dispatch(\n            setLatLon({\n              latitude: lat,\n              longitude: lon\n            })\n          );\n        };\n\n        // If the browser doesn't support geolocation or the call failed\n        // set a dummy location for purposes of the demo (Times Sq, NYC)\n        const dummyResponse = () => respond(40.75491, -73.994102);\n\n        if ('geolocation' in navigator) {\n          navigator.geolocation.getCurrentPosition(\n            ({ coords }) => {\n              respond(coords.latitude, coords.longitude);\n            },\n            (err) => {\n              dummyResponse();\n            },\n            {\n              maximumAge: Infinity,\n              timeout: 5000,\n              enableHighAccuracy: true\n            }\n          );\n        } else {\n          dummyResponse();\n        }\n      }\n    })();\n  }, [dispatch]);\n\n  const loadMap = (lat, lon) => {\n    const map = new mapboxgl.Map({\n      container: mapElem.current as HTMLDivElement,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [lon, lat],\n      zoom: 13,\n      interactive: false\n    }).on('load', () => {\n      setLoading(false);\n      // Add self marker\n      const tooltip = document.createElement('div');\n      tooltip.className = 'self-marker';\n      new mapboxgl.Marker(tooltip).setLngLat([lon, lat]).addTo(map);\n    });\n  };\n\n  return (\n    <div\n      className=\"preview-map\"\n      data-test=\"preview-map\"\n      onClick={() =>\n        hasApiKey &&\n        dispatch(\n          showDrawer({\n            component: 'snapMap',\n            animationIn: 'fadeIn',\n            animationOut: 'fadeOut',\n            animationInDuration: 0,\n            animationOutDuration: 0,\n            theme: 'stripped'\n          })\n        )\n      }\n    >\n      {!hasApiKey ? (\n        <div className=\"api-key-msg\">\n          <p>\n            <span role=\"img\" aria-label=\"earth emoji\">\n              🌎\n            </span>{' '}\n            Get a free mapboxgl{' '}\n            <a\n              href=\"https://docs.mapbox.com/help/glossary/access-token/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              API key here\n            </a>\n            , then rename the <code>.env.sample</code> file at the root of the project to\n            just <code>.env</code> and place the key inside, finally run\n            <code>npm start</code> again to view the snap map features!\n          </p>\n        </div>\n      ) : loading ? (\n        <Loader />\n      ) : null}\n\n      {hasApiKey && <div className=\"map\" ref={mapElem}></div>}\n    </div>\n  );\n};\n\nexport default Map;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { language } from 'utils';\nimport Button from 'common/Button';\nimport Widget from 'common/Widget';\nimport PodActionItem from 'common/PodActionItem';\nimport Icon from 'common/Icon';\nimport Map from './Map';\nimport './index.scss';\n\nconst currentDate = new Date().toLocaleDateString(language, {\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric'\n});\n\nconst Account: React.FC = () => {\n  const dispatch = useDispatch();\n  const username = useSelector(({ user }) => user.session.username);\n\n  return (\n    <main className=\"account\">\n      <header>\n        <Button\n          icon=\"faAngleDown\"\n          onclick={() => dispatch(hideDrawer('account'))}\n          buttonClass=\"btn-close\"\n        />\n        <Icon icon=\"faCog\" className=\"ico-gear\" />\n      </header>\n      <div className=\"logo\">\n        <img src=\"./images/logo.svg\" alt=\"\" />\n        <strong>{username}</strong>\n      </div>\n      <Widget header=\"Stories\" transparent>\n        <PodActionItem\n          leftIcon=\"faCamera\"\n          rightIcon=\"faEllipsisV\"\n          label=\"Add to My Story\"\n        />\n        <PodActionItem\n          leftIcon=\"faCamera\"\n          rightIcon=\"faEllipsisV\"\n          label=\"Add to Our Story\"\n        />\n      </Widget>\n      <Widget header=\"Friends\" transparent>\n        <PodActionItem\n          leftIcon=\"faUserPlus\"\n          rightIcon=\"faAngleRight\"\n          label=\"Add Friends\"\n        />\n        <PodActionItem leftIcon=\"faListAlt\" rightIcon=\"faAngleRight\" label=\"My Friends\" />\n      </Widget>\n      <Widget header=\"Bitmoji\" transparent>\n        <PodActionItem\n          leftIcon=\"faGrinBeam\"\n          rightIcon=\"faAngleRight\"\n          label=\"Create Bitmoji\"\n        />\n      </Widget>\n      <Widget header=\"Snap Map\">\n        <Map />\n        <PodActionItem\n          leftIcon=\"faCompass\"\n          rightIcon=\"faAngleRight\"\n          label=\"Set a Status\"\n          straightEdge\n        />\n      </Widget>\n      <footer>\n        <p>\n          <a\n            href=\"https://github.com/TowhidKashem/snapchat-clone\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            title=\"Github Repo\"\n          >\n            <Icon icon=\"faGithub\" />\n          </a>\n          Joined SnapChat on {currentDate}\n        </p>\n      </footer>\n    </main>\n  );\n};\n\nexport default Account;\n","import React from 'react';\nimport './index.scss';\n\nexport type sizeType = 'sm' | 'md' | 'lg';\n\nexport const sizeMap = {\n  sm: 45,\n  md: 100,\n  lg: 150\n};\n\nconst Avatar: React.FC<{\n  readonly src: string;\n  readonly size?: sizeType;\n}> = ({ src, size = 'md' }) => (\n  <img src={src} className=\"avatar\" alt=\"\" width={sizeMap[size]} />\n);\n\nexport default Avatar;\n","import React from 'react';\nimport { User as UserInterface } from 'features/User/types';\nimport Avatar from 'common/Avatar';\nimport './index.scss';\n\nconst PodUser: React.FC<{\n  readonly user: UserInterface;\n}> = ({ user: { username, fullName, avatar } }) => (\n  <article className=\"pod user\">\n    <Avatar src={avatar} size=\"sm\" />\n    <div className=\"meta\">\n      <header>{fullName}</header>\n      <span>{username}</span>\n    </div>\n  </article>\n);\n\nexport default PodUser;\n","import React from 'react';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst Error: React.FC<{\n  readonly message?: string;\n}> = ({ message = \"Oops couldn't load content\" }) => (\n  <div className=\"error\">\n    <p>\n      <Icon icon=\"faExclamationCircle\" /> {message}\n    </p>\n  </div>\n);\n\nexport default Error;\n","import React, { useState, useEffect } from 'react';\nimport { Animated } from 'react-animated-css';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { escapeRegex } from 'utils';\nimport Input from 'common/Input';\nimport Button from 'common/Button';\nimport Widget from 'common/Widget';\nimport PodUser from 'common/PodUser';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\nconst Search: React.FC<{\n  readonly show: boolean;\n}> = ({ show }) => {\n  const dispatch = useDispatch();\n  const { loading, error, data } = useSelector(({ user }) => user.friends);\n  const [query, setQuery] = useState('');\n\n  useEffect(() => {\n    if (!show) setQuery('');\n  }, [show]);\n\n  const pattern = new RegExp(escapeRegex(query), 'gi');\n  const users = query\n    ? data.filter(\n        ({ fullName, username }) => fullName.match(pattern) || username.match(pattern)\n      )\n    : data;\n  const hasResults = users?.length > 0;\n\n  return (\n    <main className=\"search\">\n      <header>\n        <Input\n          placeholder=\"Search\"\n          leftIcon=\"faSearch\"\n          value={query}\n          onChange={(e) => setQuery(e.currentTarget.value)}\n          focus={show}\n          animate\n          dark\n        />\n        <Button\n          label=\"Cancel\"\n          plain\n          onclick={() => dispatch(hideDrawer('search'))}\n          testId=\"btn-cancel\"\n        />\n      </header>\n      <section>\n        {loading ? (\n          <Loader nobg />\n        ) : error ? (\n          <Error />\n        ) : (\n          <Animated\n            animationIn=\"slideInUp\"\n            animationOut=\"slideOutDown\"\n            animationInDuration={250}\n            animationOutDuration={0}\n            isVisible={show}\n          >\n            <div className=\"results\">\n              {hasResults && (\n                <Widget header=\"Quick Add\">\n                  {users.map((user) => (\n                    <PodUser key={user.id} user={user} />\n                  ))}\n                </Widget>\n              )}\n            </div>\n            {query && !hasResults && (\n              <p className=\"no-results\">\n                <span role=\"img\" aria-label=\"poop emoji\">\n                  💩\n                </span>{' '}\n                No results\n              </p>\n            )}\n          </Animated>\n        )}\n      </section>\n    </main>\n  );\n};\n\nexport default Search;\n","// Escape a user input string for use in a REGEX search\nexport const escapeRegex = (string: string) =>\n  string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport Button from 'common/Button';\nimport Icon from 'common/Icon';\nimport { conditionIconMap } from '../data';\nimport './index.scss';\n\nconst Header: React.FC = () => {\n  const dispatch = useDispatch();\n  const { city, weather } = useSelector(({ user, snapMap }) => ({\n    city: user.geolocation.city,\n    weather: snapMap.weather\n  }));\n  const { temperature, condition } = weather;\n\n  return (\n    <header className=\"weather-header\">\n      <div className=\"left\">\n        <Button\n          icon=\"faTimes\"\n          round\n          onclick={() => dispatch(hideDrawer('snapMap'))}\n          buttonClass=\"btn-close\"\n          testId=\"btn-close\"\n        />\n        <Button icon=\"faSearch\" round />\n      </div>\n      <div className=\"center\">\n        <article className=\"weather\">\n          <header>{city}</header>\n          <div className=\"condition\">\n            <Icon icon={conditionIconMap[condition]} />\n            <span className=\"temperature\">{temperature}&deg;F</span>\n          </div>\n        </article>\n      </div>\n      <div className=\"right\">\n        <Button icon=\"faCog\" round />\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","import React, { useRef, useEffect, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { addSnap } from 'features/Snap/store';\nimport { getSnaps, getWeather } from './store';\nimport { Snap } from 'features/Snap/types';\nimport { onAnimationComplete } from 'utils';\nimport Loader from 'common/Loader';\nimport Header from './Header';\nimport './index.scss';\n\nmapboxgl.accessToken = process.env.REACT_APP_MAP_BOX_API_KEY as string;\n\nconst SnapMap: React.FC = () => {\n  const dispatch = useDispatch();\n  const { geolocation, snaps } = useSelector(({ user, snapMap }) => ({\n    geolocation: user.geolocation,\n    snaps: snapMap.snaps\n  }));\n\n  const mapElem = useRef<HTMLDivElement>(null);\n  const [loading, setLoading] = useState(true);\n  const [map, setMap] = useState<mapboxgl.Map | null>(null);\n\n  const { latitude, longitude, city, state } = geolocation;\n\n  useEffect(() => {\n    dispatch(getSnaps({ lat: latitude, lon: longitude, city, state }));\n    dispatch(getWeather({ lat: latitude, lon: longitude }));\n    setMap(\n      new mapboxgl.Map({\n        container: mapElem.current as HTMLDivElement,\n        style: 'mapbox://styles/mapbox/streets-v11',\n        center: [longitude, latitude],\n        zoom: 13\n      }).on('load', () => setLoading(false))\n    );\n  }, [dispatch, latitude, longitude, city, state]);\n\n  // Add self marker on map\n  useEffect(() => {\n    if (map) {\n      const addSelfMarker = () => {\n        const tooltip = document.createElement('div');\n        tooltip.className = 'self-marker';\n\n        new mapboxgl.Marker(tooltip).setLngLat([longitude, latitude]).addTo(map);\n\n        setTimeout(() => {\n          tooltip.classList.add('zoomed-in');\n\n          new mapboxgl.Popup({ closeOnClick: false })\n            .setLngLat([longitude, latitude])\n            .setHTML(\n              `<header>Me</header>\n              <p>Not Sharing Location</p>`\n            )\n            .addTo(map);\n        }, 2300);\n      };\n\n      addSelfMarker();\n\n      // Zoom in effect on load\n      setTimeout(() => map.flyTo({ zoom: 14 }), 2000);\n    }\n  }, [map, latitude, longitude]);\n\n  // Add snaps on map after they've loaded\n  useEffect(() => {\n    const addSnapToMap = (snap: Snap) => {\n      const marker = document.createElement('div');\n      marker.className = 'marker';\n      marker.setAttribute('data-test', 'marker');\n      marker.onclick = function (e: any) {\n        // Show pulse animation\n        e.target.classList.add('active');\n        // Delay opening the drawer so we can see the pulse\n        onAnimationComplete(() => {\n          dispatch(addSnap(snap));\n          dispatch(\n            showDrawer({\n              component: 'snap',\n              animationIn: 'zoomIn',\n              animationOut: 'zoomOut',\n              theme: 'dark'\n            })\n          );\n        }, 900);\n        // Remove pulse\n        onAnimationComplete(() => e.target.classList.remove('active'), 1000);\n      };\n      new mapboxgl.Marker(marker)\n        .setLngLat([snap.lon as number, snap.lat as number])\n        .addTo(map as mapboxgl.Map);\n    };\n\n    snaps.map((snap) => addSnapToMap(snap));\n  }, [snaps, map, dispatch]);\n\n  return (\n    <div className=\"snap-map\">\n      <div className=\"inner\">\n        {loading && <Loader />}\n        <Header />\n        <div ref={mapElem} className=\"content\"></div>\n      </div>\n    </div>\n  );\n};\n\nexport default SnapMap;\n","import React, { useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { removeSnap } from './store';\nimport { onAnimationComplete, relativeTime } from 'utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst Snap: React.FC = () => {\n  const dispatch = useDispatch();\n  const snap = useSelector(({ snap }) => snap);\n  const videoElem = useRef<HTMLVideoElement>(null);\n\n  const { location, time, type, url, caption, shareable } = snap;\n\n  useEffect(() => {\n    if (type === 'video' && videoElem.current) {\n      videoElem.current.load();\n      videoElem.current.play();\n    }\n  }, [snap, type]);\n\n  const closeSnap = () => {\n    dispatch(hideDrawer('snap'));\n    onAnimationComplete(() => dispatch(removeSnap()));\n  };\n\n  return (\n    <main className=\"snap\" onClick={closeSnap} data-test=\"snap\">\n      <header className={classNames({ metadata: location || time })}>\n        {(location || time) && (\n          <div className=\"left\">\n            {location && <span data-test=\"location\">{location}</span>}\n            {time && <time data-test=\"time\">{relativeTime(time)}</time>}\n          </div>\n        )}\n        <div className=\"right\">\n          <Button icon=\"faEllipsisV\" />\n        </div>\n      </header>\n\n      {type === 'video' ? (\n        <div className=\"video-container\">\n          <video ref={videoElem} playsInline onEnded={closeSnap} data-test=\"video\">\n            <source src={url} type=\"video/mp4\" />\n          </video>\n        </div>\n      ) : (\n        <div className=\"image-container\" data-test=\"image\">\n          {caption && (\n            <div className=\"caption\" data-test=\"caption\">\n              {caption}\n            </div>\n          )}\n          <img src={url} alt=\"\" />\n        </div>\n      )}\n\n      {shareable && (\n        <footer>\n          <Button icon=\"faLocationArrow\" />\n        </footer>\n      )}\n    </main>\n  );\n};\n\nexport default Snap;\n","export const relativeTime = (timestamp: number) => {\n  const msPerMinute = 60 * 1000;\n  const msPerHour = msPerMinute * 60;\n  const msPerDay = msPerHour * 24;\n  const msPerMonth = msPerDay * 30;\n  const msPerYear = msPerDay * 365;\n\n  const elapsed = Date.now() - timestamp;\n\n  if (elapsed < msPerMinute) {\n    return Math.floor(elapsed / 1000) + ' seconds ago';\n  } else if (elapsed < msPerHour) {\n    return Math.floor(elapsed / msPerMinute) + ' minutes ago';\n  } else if (elapsed < msPerDay) {\n    return Math.floor(elapsed / msPerHour) + ' hours ago';\n  } else if (elapsed < msPerMonth) {\n    return Math.floor(elapsed / msPerDay) + ' days ago';\n  } else if (elapsed < msPerYear) {\n    return Math.floor(elapsed / msPerMonth) + ' months ago';\n  } else {\n    return Math.floor(elapsed / msPerYear) + ' years ago';\n  }\n};\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { addSnap } from 'features/Snap/store';\nimport Header from 'common/Header';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\nconst Archive: React.FC = () => {\n  const dispatch = useDispatch();\n  const { photos, photoTaken } = useSelector(({ camera }) => ({\n    photos: camera.photos,\n    photoTaken: camera.photoTaken\n  }));\n\n  const openPhoto = (image) => {\n    dispatch(\n      addSnap({\n        type: 'photo',\n        url: image,\n        shareable: true\n      })\n    );\n    dispatch(\n      showDrawer({\n        component: 'snap',\n        animationIn: 'zoomIn',\n        animationOut: 'zoomOut',\n        theme: 'dark'\n      })\n    );\n  };\n\n  return (\n    <main className=\"archive\">\n      <Header insideDrawer />\n\n      {photos.loading ? (\n        <Loader nobg />\n      ) : photos.error ? (\n        <Error />\n      ) : (\n        <>\n          <nav className=\"view-options\">\n            <Button label=\"Snaps\" buttonClass=\"active\" />\n            <Button label=\"Camera Roll\" />\n          </nav>\n\n          {!photoTaken && (\n            <section className=\"message\" data-test=\"placeholder-msg\">\n              <p>Take a photo and it will appear here!</p>\n            </section>\n          )}\n\n          {photos.data.map(({ month, year, images }) => (\n            <section key={month} className=\"month\" data-test=\"month\">\n              <h3>\n                {month} {year}\n              </h3>\n              {images.map((image, index) => (\n                <img\n                  key={image + index}\n                  src={image}\n                  width={100}\n                  alt=\"\"\n                  onClick={() => openPhoto(image)}\n                  data-test=\"snap-image\"\n                />\n              ))}\n            </section>\n          ))}\n        </>\n      )}\n    </main>\n  );\n};\n\nexport default Archive;\n","export const dummyMessages = [\n  \"Oh wow I can't believe it!\",\n  \"Hahaha you're so right!!\",\n  'No way, when?!! 😱',\n  'OMG I totally agree!',\n  \"Umm I'm not so sure about that one 🤨\",\n  'Wait, you are actually being serious rn?',\n  \"Hahahahaha you're too much 😂😂😂\",\n  'Did you watch the new show last night?',\n  '🤡'\n];\n","import React from 'react';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst Pill: React.FC<{\n  readonly icons: string[];\n}> = ({ icons }) => (\n  <div className=\"pill\">\n    {icons.map((icon) => (\n      <Button key={icon} icon={icon} />\n    ))}\n  </div>\n);\n\nexport default Pill;\n","import React, { useEffect, useLayoutEffect, useState, useRef, useCallback } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { getMessages, postMessage } from './store';\nimport { dummyMessages } from './data';\nimport { randomArrayVal, playSound, sleep } from 'utils';\nimport Input from 'common/Input';\nimport Avatar from 'common/Avatar';\nimport Pill from 'common/Pill';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\nconst Chat: React.FC = () => {\n  const dispatch = useDispatch();\n  const { username, thread, messages } = useSelector(({ user, chat }) => ({\n    username: user.session.username,\n    thread: chat.thread,\n    messages: chat.messages\n  }));\n\n  const messageContainer = useRef<HTMLElement>(null);\n  const audioElem = useRef<HTMLAudioElement>(null);\n\n  const [message, setMessage] = useState('');\n  const [typing, setTyping] = useState(false);\n\n  useLayoutEffect(() => {\n    // Scroll to bottom of container on load and each time a new message is posted\n    if (messageContainer.current)\n      messageContainer.current.scrollTop = messageContainer.current.scrollHeight;\n  }, [messages]);\n\n  const botResponse = useCallback(\n    async (firstMsg?: boolean) => {\n      // Pretend to type for a bit...\n      const typeAndStop = firstMsg ? [1000, 0] : [800, 500, 1000, 700, 600, 0];\n      for (let i = 0; i < typeAndStop.length; i++) {\n        setTyping((prevTyping) => !prevTyping);\n        await sleep(typeAndStop[i]);\n        continue;\n      }\n      const message = firstMsg ? 'Soooo, how was it!?' : randomArrayVal(dummyMessages);\n      dispatch(postMessage(thread, message));\n      if (audioElem.current) playSound('newAppMessage', audioElem.current);\n    },\n    [thread, dispatch]\n  );\n\n  useEffect(() => {\n    dispatch(getMessages(thread));\n    botResponse(true);\n  }, [thread, botResponse, dispatch]);\n\n  const submitMessage = () => {\n    if (!message.length) return;\n    dispatch(postMessage(username, message));\n    setMessage('');\n    setTimeout(botResponse, 1000);\n  };\n\n  return (\n    <main className=\"chat\">\n      <header>\n        <Avatar src=\"./images/bitmoji-other.png\" />\n        <h2>{thread}</h2>\n        <div className=\"right\">\n          <Pill icons={['faPhoneAlt', 'faVideo']} />\n          <Button\n            icon=\"faAngleRight\"\n            onclick={() => dispatch(hideDrawer('chat'))}\n            buttonClass=\"btn-arrow\"\n            testId=\"btn-close-chat\"\n          />\n        </div>\n      </header>\n\n      <section ref={messageContainer} className=\"messages\">\n        {messages.loading ? (\n          <Loader nobg />\n        ) : messages.error ? (\n          <Error />\n        ) : (\n          messages.data.map(({ author, message, time }) => (\n            <article\n              key={time}\n              className={classNames('message', {\n                other: author !== username\n              })}\n              data-test=\"message\"\n            >\n              <header>{author !== username ? author : 'Me'}</header>\n              <blockquote>{message}</blockquote>\n            </article>\n          ))\n        )}\n      </section>\n\n      <footer>\n        <div className={classNames('gravatar', { typing })}>\n          <Avatar src=\"./images/bitmoji-other.png\" />\n        </div>\n        <div className=\"inner-content\">\n          <Button icon=\"faCamera\" buttonClass=\"btn-camera\" round />\n          <Input\n            placeholder=\"Send a chat\"\n            rightIcon=\"faMicrophone\"\n            onChange={(e: React.SyntheticEvent<HTMLInputElement>) =>\n              setMessage(e.currentTarget.value)\n            }\n            onEnter={submitMessage}\n            onBlur={submitMessage}\n            value={message}\n          />\n          <div className=\"right\">\n            <Button icon=\"faSmileWink\" />\n            <Button icons={['faMobile', 'faMobileAlt']} buttonClass=\"btn-archive\" />\n            <Button icon=\"faRocket\" />\n          </div>\n        </div>\n      </footer>\n\n      <audio ref={audioElem} className=\"app-sound\"></audio>\n    </main>\n  );\n};\n\nexport default Chat;\n","export const randomArrayVal = (arr) => arr[Math.floor(Math.random() * arr.length)];\n","import React from 'react';\nimport './index.scss';\n\nconst SkeletonFrame: React.FC<{\n  readonly count?: number;\n}> = ({ count = 1 }) => (\n  <>\n    {new Array(count).fill(null).map((val, index) => (\n      <article key={`frame-${index}`} className=\"skeleton-frame\"></article>\n    ))}\n  </>\n);\n\nexport default SkeletonFrame;\n","import React from 'react';\nimport './index.scss';\n\nconst PodSpotlight: React.FC<{\n  readonly title: string;\n  readonly image: string;\n  readonly testId?: string;\n}> = ({ title, image, testId }) => (\n  <article className=\"pod spotlight\" data-test={testId}>\n    <img src={image} alt=\"\" />\n    <div className=\"meta\">\n      <header>{title}</header>\n    </div>\n  </article>\n);\n\nexport default PodSpotlight;\n","import React, { useEffect, useState, useRef } from 'react';\nimport { api, sleep, debounce, elemInView } from 'utils';\nimport Header from 'common/Header';\nimport Widget from 'common/Widget';\nimport Button from 'common/Button';\nimport SkeletonFrame from 'common/SkeletonFrame';\nimport PodSpotlight from 'common/PodSpotlight';\nimport { Profile } from './types';\nimport './index.scss';\n\nconst Discover: React.FC<{\n  readonly drawerContent;\n}> = ({ drawerContent }) => {\n  const loadMore = useRef(null);\n  const isFetching = useRef(false);\n  const onScroll = useRef(\n    debounce(() => {\n      if (!isFetching.current && elemInView(loadMore.current))\n        setPage((prevPage) => prevPage + 1);\n    }, 10)\n  );\n\n  const [page, setPage] = useState(1);\n  const [profiles, setProfiles] = useState<Profile[]>([]);\n\n  useEffect(() => {\n    drawerContent.current.addEventListener('scroll', onScroll.current);\n  }, [drawerContent]);\n\n  // Infinite scroll\n  useEffect(() => {\n    (async () => {\n      isFetching.current = true;\n      const [error, response] = await api.get(`/discover/page/${page}.json`);\n      if (!error) {\n        // Simulate slow API response on the first call to show off skeleton frames\n        if (page === 1) await sleep(1000);\n        setProfiles((prevProfiles) => [...prevProfiles, ...response.discover]);\n        isFetching.current = false;\n      }\n      if (page === 3)\n        drawerContent.current.removeEventListener('scroll', onScroll.current);\n    })();\n  }, [page, drawerContent]);\n\n  return (\n    <main className=\"discover\">\n      <Header insideDrawer />\n      <section className=\"view\">\n        <Widget className=\"friends\" header=\"Friends\" transparent>\n          <p>Stories from your friends will appear here.</p>\n          <Button label=\"Add Friends\" purple />\n        </Widget>\n        <Widget header=\"For You\" transparent>\n          <div className=\"inner\">\n            {profiles.length ? (\n              profiles.map(({ image, title }) => (\n                <PodSpotlight\n                  key={image}\n                  image={image}\n                  title={title}\n                  testId=\"discover-item\"\n                />\n              ))\n            ) : (\n              <SkeletonFrame count={10} />\n            )}\n          </div>\n        </Widget>\n        <div ref={loadMore} className=\"load-more\"></div>\n      </section>\n    </main>\n  );\n};\n\nexport default Discover;\n","// https://css-tricks.com/the-trick-to-viewport-units-on-mobile/\nexport const stretchViewPortHeight = (elem = document.documentElement) => {\n  const viewportHeight = window.innerHeight * 0.01;\n  elem.style.setProperty('--vh', viewportHeight + 'px');\n};\n\nexport const elemInView = (elem, fullyVisible?): boolean => {\n  const position = elem.getBoundingClientRect();\n  const elemTop = position.top;\n  const elemBottom = position.bottom;\n  const isVisible = fullyVisible\n    ? elemTop >= 0 && elemBottom <= window.innerHeight\n    : elemTop < window.innerHeight && elemBottom >= 0;\n  return isVisible;\n};\n","import React, { useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { onAnimationComplete } from 'utils';\nimport { AnimationType } from '../types';\nimport Account from 'features/Account';\nimport Search from 'features/Search';\nimport SnapMap from 'features/SnapMap';\nimport Snap from 'features/Snap';\nimport Archive from 'features/Archive';\nimport Chat from 'features/Chat';\nimport Discover from 'features/Discover';\nimport './index.scss';\n\nconst Drawer: React.FC = () => {\n  const drawers = useSelector(({ app }) => app.drawers);\n  const drawerContent = useRef(null);\n\n  const getComponent = (component, show) => {\n    const componentMap = {\n      account: <Account />,\n      search: <Search show={show} />,\n      snapMap: <SnapMap />,\n      snap: <Snap />,\n      archive: <Archive />,\n      chat: <Chat />,\n      discover: <Discover drawerContent={drawerContent} />\n    };\n    return componentMap[component];\n  };\n\n  return (\n    <>\n      {drawers &&\n        drawers.map(\n          ({\n            component,\n            animationIn,\n            animationOut,\n            animationInDuration,\n            animationOutDuration,\n            show,\n            theme,\n            position\n          }) => {\n            const elem = document.getElementById(component);\n            if (show) {\n              elem?.classList.remove('collapse');\n            } else {\n              onAnimationComplete(\n                () => elem?.classList.add('collapse'),\n                animationOutDuration\n              );\n            }\n\n            return (\n              <aside\n                id={component}\n                key={component}\n                className={classNames('drawer', {\n                  [theme as string]: true,\n                  [position as string]: true\n                })}\n              >\n                <div className=\"view\" data-test={`${component}-drawer`}>\n                  <Animated\n                    animationIn={animationIn as AnimationType}\n                    animationOut={animationOut as AnimationType}\n                    animationInDuration={animationInDuration}\n                    animationOutDuration={animationOutDuration}\n                    isVisible={show as boolean}\n                  >\n                    <section\n                      ref={drawerContent}\n                      className=\"content\"\n                      data-test=\"drawer-content\"\n                      style={{ height: window.innerHeight + 'px' }}\n                    >\n                      {getComponent(component, show)}\n                    </section>\n                  </Animated>\n                </div>\n              </aside>\n            );\n          }\n        )}\n    </>\n  );\n};\n\nexport default Drawer;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { showDrawer, hideAllDrawers, setFooterType } from 'AppShell/store';\nimport { atleastOneDrawerOpen } from '../utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst Footer: React.FC = () => {\n  const dispatch = useDispatch();\n  const { drawers, footerType } = useSelector(({ app }) => ({\n    drawers: app.drawers,\n    footerType: app.footerType\n  }));\n\n  return (\n    <>\n      {footerType !== 'none' && (\n        <footer\n          className={classNames('footer', {\n            'light-shadow': atleastOneDrawerOpen(drawers)\n          })}\n        >\n          <div className=\"left\">\n            <Button\n              icons={['faCommentAlt', 'faDot']}\n              iconClasses={[null, 'new-msg']}\n              buttonClass=\"btn-chat\"\n              testId=\"btn-chat\"\n              label=\"Chat\"\n              onclick={() =>\n                dispatch(\n                  showDrawer({\n                    component: 'chat',\n                    animationIn: 'slideInLeft',\n                    animationOut: 'slideOutLeft',\n                    theme: 'stripped'\n                  })\n                )\n              }\n            />\n          </div>\n          <div className=\"center\">\n            <Animated\n              animationIn=\"zoomIn\"\n              animationOut=\"zoomOut\"\n              animationInDuration={500}\n              animationOutDuration={500}\n              isVisible={footerType === 'collapsed'}\n              animateOnMount={false}\n            >\n              <Button\n                icon=\"faCircle\"\n                buttonClass=\"btn-capture\"\n                testId=\"btn-capture-footer\"\n                onclick={() => {\n                  dispatch(setFooterType('full'));\n                  dispatch(hideAllDrawers());\n                }}\n              />\n            </Animated>\n            <Animated\n              animationIn=\"zoomIn\"\n              animationOut=\"zoomOut\"\n              animationInDuration={500}\n              animationOutDuration={500}\n              isVisible={footerType === 'full'}\n              animateOnMount={false}\n            >\n              <Button\n                icons={['faMobile', 'faMobileAlt']}\n                buttonClass=\"btn-archive\"\n                testId=\"btn-archive\"\n                onclick={() => {\n                  dispatch(setFooterType('collapsed'));\n                  dispatch(\n                    showDrawer({\n                      component: 'archive',\n                      animationIn: 'slideInUp',\n                      animationOut: 'slideOutDown',\n                      position: 'back'\n                    })\n                  );\n                }}\n              />\n            </Animated>\n          </div>\n          <div className=\"right\">\n            <Button\n              icons={['faMobile', 'faMobile']}\n              buttonClass=\"btn-discover\"\n              testId=\"btn-discover\"\n              label=\"Discover\"\n              onclick={() => {\n                dispatch(setFooterType('collapsed'));\n                dispatch(\n                  showDrawer({\n                    component: 'discover',\n                    animationIn: 'slideInRight',\n                    animationOut: 'slideOutRight',\n                    position: 'back'\n                  })\n                );\n              }}\n            />\n          </div>\n        </footer>\n      )}\n    </>\n  );\n};\n\nexport default Footer;\n","import React, { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { getSession, getFriends } from 'features/User/store';\nimport { getPhotos } from 'features/Camera/store';\nimport Header from 'common/Header';\nimport Toolbar from './Toolbar';\nimport Drawer from './Drawer';\nimport Footer from './Footer';\n\nconst AppShell: React.FC = ({ children }) => {\n  const dispatch = useDispatch();\n\n  // Init the app\n  useEffect(() => {\n    dispatch(getSession());\n    dispatch(getFriends());\n    dispatch(getPhotos());\n  }, [dispatch]);\n\n  return (\n    <>\n      <Toolbar />\n      <Header />\n      <section className=\"view\">{children}</section>\n      <Drawer />\n      <Footer />\n    </>\n  );\n};\n\nexport default AppShell;\n","import React, { useRef, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { setPhoto } from '../store';\nimport { isIOS, stretchViewPortHeight } from 'utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst PhotoCapture: React.FC<{\n  readonly takePic: boolean;\n  readonly closePic: () => void;\n  readonly videoElem: HTMLVideoElement;\n}> = ({ takePic, closePic, videoElem }) => {\n  const dispatch = useDispatch();\n  const canvasElem = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    stretchViewPortHeight();\n  }, []);\n\n  const getDataURL = () => canvasElem?.current?.toDataURL('image/png') || '';\n\n  useEffect(() => {\n    const takePhoto = () => {\n      const { innerWidth, innerHeight } = window;\n      const context = canvasElem?.current?.getContext('2d');\n      if (context) {\n        context.canvas.width = innerWidth;\n        context.canvas.height = innerHeight;\n        context.drawImage(videoElem, 0, 0, innerWidth, innerHeight);\n      }\n    };\n    if (takePic) {\n      takePhoto();\n      dispatch(setPhoto(getDataURL()));\n    }\n  }, [takePic, videoElem, dispatch]);\n\n  const downloadPhoto = () => {\n    const dataURL = getDataURL();\n    if (isIOS()) {\n      window.open(dataURL, '_blank');\n    } else {\n      const link = document.createElement('a');\n      link.download = 'download.png';\n      link.href = dataURL;\n      link.click();\n    }\n  };\n\n  const buttons = [\n    'faTextHeight',\n    'faPen',\n    'faStickyNote',\n    'faCut',\n    'faPaperclip',\n    'faCropAlt',\n    'faStopwatch'\n  ];\n\n  return (\n    <section\n      data-test=\"photo-capture\"\n      className={classNames('photo-capture', { hide: !takePic })}\n    >\n      <div className=\"inner\">\n        <header>\n          <Button icon=\"faTimes\" onclick={closePic} testId=\"btn-close\" />\n        </header>\n        <canvas ref={canvasElem}></canvas>\n        <aside>\n          {buttons.map((button) => (\n            <Button key={button} icon={button} />\n          ))}\n        </aside>\n        <footer>\n          <div className=\"left\">\n            <Button\n              icon=\"faDownload\"\n              label=\"Save\"\n              onclick={downloadPhoto}\n              buttonClass=\"btn-download\"\n            />\n            <Button icon=\"faExternalLinkAlt\" label=\"Story\" />\n          </div>\n          <div className=\"right\">\n            <Button icon=\"faPlayCircle\" label=\"Send To\" />\n          </div>\n        </footer>\n      </div>\n    </section>\n  );\n};\n\nexport default PhotoCapture;\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setFooterType } from 'AppShell/store';\nimport { Filter, FilterScript } from './types';\nimport { promise, playSound, onAnimationComplete } from 'utils';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport PhotoCapture from './PhotoCapture';\nimport './index.scss';\n\ndeclare global {\n  interface Window {\n    JEEFACEFILTERAPI: any;\n    Filters: FilterScript;\n  }\n}\n\nconst defaultFilters: Filter[] = ['dog', 'halloween', 'deform', 'bees', 'liberty'];\n\nconst errorMessageMap = {\n  GL_INCOMPATIBLE: 'Browser does not support webGL'\n};\n\nconst Camera: React.FC = () => {\n  const dispatch = useDispatch();\n  const cameraMode = useSelector(({ camera }) => camera.cameraMode);\n\n  const videoElem = useRef<HTMLVideoElement>(null);\n  const audioElem = useRef<HTMLAudioElement>(null);\n\n  const [loading, setLoading] = useState(false);\n  const [showFilterButtons, setShowFilterButtons] = useState(false);\n  const [filters, setFilters] = useState<Filter[]>(defaultFilters);\n  const [activeFilter, setActiveFilter] = useState<Filter>('');\n  const [filterInitialized, setFilterInitialized] = useState(false);\n  const [cameraStream, setCameraStream] = useState(null);\n  const [takePic, setTakePic] = useState(false);\n  const [hasBrowserSupport, setHasBrowserSupport] = useState(true);\n\n  const startCamera = useCallback(async () => {\n    const navigator: any = window.navigator;\n    const maxWidth = (document.querySelector('#wrapper') as HTMLDivElement)?.offsetWidth;\n\n    if (!('mediaDevices' in navigator)) navigator.mediaDevices = {};\n    if (!('getUserMedia' in navigator.mediaDevices)) {\n      navigator.mediaDevices.getUserMedia = (constraints) => {\n        const getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n        if (!getUserMedia)\n          return Promise.reject(new Error('getUserMedia() is not implemented!'));\n        else\n          return new Promise((resolve, reject) =>\n            getUserMedia.call(navigator, constraints, resolve, reject)\n          );\n      };\n    }\n\n    const [error, response] = await promise(\n      navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: cameraMode,\n          width: { ideal: maxWidth }\n        }\n      })\n    );\n\n    if (!error && videoElem.current) {\n      videoElem.current.srcObject = response;\n      setCameraStream(response);\n    } else {\n      setHasBrowserSupport(false);\n    }\n  }, [cameraMode]);\n\n  // Set the chosen filter at the center of the nav\n  const setActiveFilterButton = (selectFilter: Filter) => {\n    const newFilters = filters.filter((filter) => filter !== selectFilter);\n    newFilters.splice(2, 0, selectFilter);\n    setFilters(newFilters);\n  };\n\n  const switchFilter = async (selectFilter: Filter) => {\n    if (selectFilter === activeFilter) return;\n    setLoading(true);\n    setActiveFilterButton(selectFilter);\n    if (filterInitialized) {\n      const [error] = await promise(window.JEEFACEFILTERAPI.destroy());\n      if (!error) setActiveFilter(selectFilter);\n    } else {\n      setActiveFilter(selectFilter);\n    }\n  };\n\n  const stopFilter = useCallback(() => {\n    setActiveFilter('');\n    setShowFilterButtons(false);\n    setFilterInitialized(false);\n    dispatch(setFooterType('full'));\n    startCamera();\n    window.JEEFACEFILTERAPI.destroy();\n  }, [dispatch, startCamera]);\n\n  useEffect(() => {\n    startCamera();\n  }, [startCamera]);\n\n  useEffect(() => {\n    if (!activeFilter) return;\n\n    const stopCamera = () =>\n      (cameraStream as any).getTracks().forEach((track) => track.stop());\n\n    window.Filters[activeFilter].init((errCode) => {\n      if (errCode) {\n        alert(errorMessageMap[errCode] || 'Something went wrong!');\n        setLoading(false);\n        stopFilter();\n      } else {\n        setFilterInitialized(true);\n        setLoading(false);\n        stopCamera();\n      }\n    });\n  }, [activeFilter, cameraStream, stopFilter]);\n\n  const showOpenMouth = (): boolean =>\n    !loading && ['dog', 'halloween'].includes(activeFilter);\n\n  return (\n    <main className=\"camera\">\n      {loading && <Loader message=\"Applying Filter\" fixed />}\n\n      {!hasBrowserSupport && (\n        <div className=\"not-supported\">\n          <p>\n            <span role=\"img\" aria-label=\"crying emoji\">\n              😭\n            </span>{' '}\n            Either your browser doesn't support the getUserMedia API used by the camera or\n            you declined camera access!\n          </p>\n        </div>\n      )}\n\n      <Animated\n        animationIn=\"tada\"\n        animationOut=\"fadeOut\"\n        animationInDuration={1000}\n        animationOutDuration={0}\n        isVisible={showOpenMouth()}\n        animateOnMount={false}\n      >\n        <div className=\"open-mouth\">\n          <strong>Open Mouth</strong>\n          <span role=\"img\" aria-label=\"tongue emoji\">\n            👅\n          </span>\n        </div>\n      </Animated>\n\n      <video\n        ref={videoElem}\n        muted\n        playsInline\n        autoPlay\n        className={classNames('video-stream', {\n          hide: filterInitialized || takePic\n        })}\n      />\n\n      <PhotoCapture\n        takePic={takePic}\n        closePic={() => setTakePic(false)}\n        videoElem={videoElem.current as HTMLVideoElement}\n      />\n\n      <section className=\"controls\">\n        <Button\n          icon=\"faCircle\"\n          buttonClass=\"btn-capture\"\n          testId=\"btn-capture-main\"\n          onclick={() => {\n            if (hasBrowserSupport) {\n              setTakePic(true);\n              if (audioElem.current) playSound('cameraShutter', audioElem.current);\n            }\n          }}\n        />\n\n        {!showFilterButtons && (\n          <Button\n            icon=\"faLaugh\"\n            buttonClass=\"btn-filters\"\n            testId=\"btn-filters\"\n            onclick={() => {\n              if (hasBrowserSupport) {\n                setShowFilterButtons(true);\n                dispatch(setFooterType('none'));\n                onAnimationComplete(() => switchFilter(filters[2]), 100); // Load the center filter on the button list by default\n              }\n            }}\n          />\n        )}\n\n        <Animated\n          animationIn=\"zoomIn\"\n          animationOut=\"zoomOut\"\n          animationInDuration={100}\n          animationOutDuration={100}\n          isVisible={showFilterButtons}\n          animateOnMount={false}\n        >\n          <div className=\"filters\" data-test=\"filters\">\n            {filters.map((filter) => (\n              <Button\n                key={filter}\n                image={'./images/filter-' + filter + '.svg'}\n                buttonClass={'filter-' + filter}\n                onclick={() => switchFilter(filter)}\n              />\n            ))}\n          </div>\n\n          <div className=\"filter-actions\">\n            <Button icon=\"faMagic\" round />\n            <Button icon=\"faQrcode\" round />\n            <Button icon=\"faTimesCircle\" buttonClass=\"btn-close\" onclick={stopFilter} />\n            <Button icon=\"faLaugh\" round />\n            <Button icon=\"faSearch\" round />\n          </div>\n        </Animated>\n      </section>\n\n      <audio ref={audioElem} className=\"app-sound\"></audio>\n    </main>\n  );\n};\n\nexport default Camera;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst NotFound = () => (\n  <main className=\"not-found\">\n    <div className=\"message\">\n      <h1>Well, this is awkward!</h1>\n      <p>We couldn't find what you were looking for</p>\n      <Link to=\"/\">\n        <Icon icon=\"faSnapchatSquare\" />\n        <span>Go Home</span>\n      </Link>\n    </div>\n  </main>\n);\n\nexport default NotFound;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport { configureStore } from '@reduxjs/toolkit';\nimport { Provider } from 'react-redux';\n\nimport app from 'AppShell/store';\nimport camera from 'features/Camera/store';\nimport user from 'features/User/store';\nimport snapMap from 'features/SnapMap/store';\nimport snap from 'features/Snap/store';\nimport chat from 'features/Chat/store';\n\nimport AppShell from 'AppShell';\nimport Camera from 'features/Camera';\nimport NotFound from 'features/404';\n\nimport 'normalize.css';\nimport 'animate.css';\nimport './styles/app.scss';\n\nexport const store = configureStore({\n  reducer: { app, camera, user, snapMap, snap, chat }\n});\n\nconst App = () => (\n  <React.StrictMode>\n    <Provider store={store}>\n      <Router>\n        <AppShell>\n          <Switch>\n            <Route path=\"/\" exact component={Camera} />\n            <Route path=\"/snapchat-clone\" exact component={Camera} />\n            <Route component={NotFound} />\n          </Switch>\n        </AppShell>\n      </Router>\n    </Provider>\n  </React.StrictMode>\n);\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}